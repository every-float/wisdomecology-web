<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="../../common/commonCss.js"></script>
    <script type="text/javascript" src="../../common/commonUrl.js"></script>
    <script type="text/javascript" src="../../common/commonJs.js"></script>
    <style>
        [v-cloak]{
            display: none;
        }
        td{
            text-align:center;
            cursor: pointer;
        }
        td.item{
            /*background: url('../../images/tools/checked.png') right bottom no-repeat;*/
        }
        td.active{
            background: url('../../images/tools/checked.png') right bottom no-repeat #ccc;
        }

        /* 横向滚动 */
       #demoMw2 {
           white-space: nowrap;
           overflow: auto;
           padding: 47px 15px;
       }
    </style>
    <title>统计</title>
</head>

<body>
    <div id="app" v-cloak>
        <div class="layui-fluid">
            <div class="layui-card">
                <div class="layui-card-body">
                    <!-- <div id="fnSure">确定</div> -->
                    <form id="exportExcelForm" class="layui-form" action="">
                        <div class="layui-form-item" style="display: none;">
                            <div class="layui-inline">
                                <label class="layui-form-label" for="">单位名称</label>
                                <div class="layui-input-inline">
                                    <input type="text" class="layui-input" id="search_companyName" name="search_companyName">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item" style="display: none;">
                            <div class="layui-inline">
                                <label class="layui-form-label" for="">单位名称</label>
                                <div class="layui-input-inline">
                                    <input type="text" class="layui-input" id="headersJson" name="headersJson">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label" for=""></label>
                            <div class="layui-input-inline">
                                <button id="submitBtn" style="display: none;" class="layui-btn" type="submit">导出</button>
                                <a id="exportExcelSubmit" class="layui-btn">导出</a>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="layui-card-body" id="demoMw2">
                    <table width="5920px" border="1">
                        <tr align="center" valign="middle">
                            <td width="100" rowspan="2" class="item" title="company_name" :class="company_name.checked?'active':''">单位名称</td>
                            <td width="100" rowspan="2" class="item" title="address" :class="address.checked?'active':''">地址</td>
                            <td width="100" rowspan="2" class="item" title="legal_representative" :class="legal_representative.checked?'active':''">法定代表人</td>
                            <td width="100" rowspan="2" class="item" title="contact" :class="contact.checked?'active':''">联系人</td>
                            <td width="100" rowspan="2" class="item" title="phone" :class="phone.checked?'active':''">联系电话</td>
                            <td width="100" rowspan="2" class="item" title="credit_code" :class="credit_code.checked?'active':''">社会统一信用代码（营业执照、组织机构代码）</td>
                            <td width="100" rowspan="2" class="item" title="industry_type" :class="industry_type.checked?'active':''">行业类别</td>
                            <td height="55" colspan="2">报告书或报告表</td>
                            <td width="100">登记表或现状环评</td>
                            <td colspan="4">主要污染物类别</td>
                            <td width="100" rowspan="2" class="item" title="is_zdpwdw" :class="is_zdpwdw.checked?'active':''">是否为重点排污单位（年度）</td>
                            <td width="100" rowspan="2" class="item" title="zyscgy" :class="zyscgy.checked?'active':''">主要生产工艺</td>
                            <td width="100" rowspan="2" class="item" title="zycp" :class="zycp.checked?'active':''">主要产品</td>
                            <td width="150" rowspan="2" class="item" title="zyyl" :class="zyyl.checked?'active':''">主要原料</td>
                            <td colspan="4">废水</td>
                            <td colspan="3">废气</td>
                            <td colspan="3">危险废物</td>
                            <td colspan="3">自动监测设施</td>
                            <td colspan="2">工况用电监测装置</td>
                            <td colspan="2">环境信息公开方式</td>
                            <td colspan="2">环境风险源</td>
                            <td colspan="4">放射源</td>
                            <td colspan="3">射线装置</td>
                            <td width="100" rowspan="2" class="item" title="pwxkzbh" :class="pwxkzbh.checked?'active':''">排污许可证编号</td>
                            <td colspan="3">重污染天气应急</td>
                        </tr>
                        <tr>
                            <td width="100" height="103" align="center" valign="middle" class="item" class="item" title="bgs_pfwh" :class="bgs.children[0].checked?'active':''">批复文号</td>
                            <td width="100" align="center" valign="middle" class="item" class="item" title="bgs_yswh" :class="bgs.children[1].checked?'active':''">验收文号</td>
                            <td width="100" align="center" valign="middle" class="item" class="item" title="djb_bawh" :class="djb.children[0].checked?'active':''">备案文号</td>
                            <td width="100" class="item" title="wrw_fs" :class="wrw.children[0].checked?'active':''">废水</td>
                            <td width="100" class="item" title="wrw_fq" :class="wrw.children[1].checked?'active':''">废气</td>
                            <td width="100" class="item" title="wrw_fw" :class="wrw.children[2].checked?'active':''">固体废物</td>
                            <td width="100" class="item" title="wrw_zs" :class="wrw.children[3].checked?'active':''">噪声</td>
                            <td width="100" class="item" title="fs_zlgy" :class="fs.children[0].checked?'active':''">废水治理工艺</td>
                            <td width="100" class="item" title="fs_pfksl" :class="fs.children[1].checked?'active':''">废水排放口数量</td>
                            <td width="100" class="item" title="fs_sfgf" :class="fs.children[2].checked?'active':''">是否设置规范化废水排放口</td>
                            <td width="100" class="item" title="fs_pfqs" :class="fs.children[3].checked?'active':''">废水排放去向</td>
                            <td width="100" class="item" title="fq_zlgy" :class="fq.children[0].checked?'active':''">废气治理工艺</td>
                            <td width="100" class="item" title="fq_pfksl" :class="fq.children[1].checked?'active':''">废气排放口数量</td>
                            <td width="100" class="item" title="fq_sfgf" :class="fq.children[2].checked?'active':''">是否设置规范化废气排放口</td>
                            <td width="100" class="item" title="fw_sfywfbz" :class="fw.children[0].checked?'active':''">是否有危废标志</td>
                            <td width="100" class="item" title="fw_sfgf" :class="fw.children[1].checked?'active':''">储存场所是否规范</td>
                            <td width="100" class="item" title="fw_sfflcf" :class="fw.children[2].checked?'active':''">是否分类存放</td>
                            <td width="100" class="item" title="zd_jcfs" :class="zd.children[0].checked?'active':''">废水（监测因子）</td>
                            <td width="100" class="item" title="zd_jcfq" :class="zd.children[1].checked?'active':''">废气（监测因子）</td>
                            <td width="100" class="item" title="zd_lwqk" :class="zd.children[2].checked?'active':''">联网情况</td>
                            <td width="100" class="item" title="gk_sfaz" :class="gk1.children[0].checked?'active':''">是否安装工况用电监测装置</td>
                            <td width="100" class="item" title="gk_azsl" :class="gk1.children[1].checked?'active':''">工况用电监测装置数量</td>
                            <td width="100" class="item" title="gk_gkfs" :class="gk2.children[0].checked?'active':''">公示栏或电子屏</td>
                            <td width="100" class="item" title="gk_gkwz" :class="gk2.children[1].checked?'active':''">网站</td>
                            <td width="100" class="item" title="fx_sfyjya" :class="fx.children[0].checked?'active':''">是否编制突发环境事件应急预案</td>
                            <td width="100" class="item" title="fx_sfyaba" :class="fx.children[1].checked?'active':''">应急预案是否备案</td>
                            <td width="100" class="item" title="fsy_fsyzl" :class="fsy.children[0].checked?'active':''">放射源种类</td>
                            <td width="100" class="item" title="fsy_twsmc" :class="fsy.children[1].checked?'active':''">放射性同位素名称</td>
                            <td width="100" class="item" title="fsy_fsysl" :class="fsy.children[2].checked?'active':''">放射源数量</td>
                            <td width="100" class="item" title="fsy_xkzbh" :class="fsy.children[3].checked?'active':''">辐射安全许可证编号</td>
                            <td width="100" class="item" title="sx_zzzl" :class="sx.children[0].checked?'active':''">射线装置种类</td>
                            <td width="100" class="item" title="sx_zzmc" :class="sx.children[1].checked?'active':''">射线装置名称</td>
                            <td width="100" class="item" title="sx_zzsl" :class="sx.children[2].checked?'active':''">射线装置数量</td>
                            <td width="100" class="item" title="tqyj_sfsyyjdw" :class="tqyj.children[0].checked?'active':''">是否属于重污染天气应急减排单位</td>
                            <td width="100" class="item" title="tqyj_sfyjya" :class="tqyj.children[1].checked?'active':''">是否制订重污染天气应急预案并备案</td>
                            <td width="100" class="item" title="tqyj_sfhmqy" :class="tqyj.children[2].checked?'active':''">是否属于豁免名单内企业</td>
                        </tr>
                    </table>
                    <!-- <span class="layui-badge layui-bg-gray">很有想法的</span>
                        <span class="layui-badge layui-bg-gray">专注设计</span>
                        <span class="layui-badge layui-bg-gray">辣~</span>
                        <span class="layui-badge layui-bg-gray">大长腿</span>
                        <span class="layui-badge layui-bg-gray">川妹子</span>
                        <span class="layui-badge layui-bg-gray">海纳百川</span>
                        <span class="layui-badge layui-bg-gray">萌萌哒</span>
                        <span class="layui-badge layui-bg-gray">萝莉</span>
                        <span class="layui-badge layui-bg-gray">宅男拯救世界</span>
                        <span class="layui-badge layui-bg-gray">我这么美我不能死</span>
                        <span class="layui-badge layui-bg-gray">小清新</span>
                        <span class="layui-badge layui-bg-gray">萌新求带</span>
                        <span class="layui-badge layui-bg-gray">吃饱了才有力气减肥</span>
                        <span class="layui-badge layui-bg-gray">穷游党</span>
                        <span class="layui-badge layui-bg-gray">夜猫子</span>
                        <span class="layui-badge layui-bg-gray">做一个开心的吃货</span>
                        <span class="layui-badge layui-bg-gray">铲屎官</span>
                        <span class="layui-badge layui-bg-gray">逗比</span>
                        <span class="layui-badge layui-bg-gray">为了联盟</span>
                        <span class="layui-badge layui-bg-gray">选择恐惧症</span>
                        <span class="layui-badge layui-bg-gray">玄不救非，氪不改命</span>
                        <span class="layui-badge layui-bg-gray">背包客</span>
                        <span class="layui-badge layui-bg-gray">追剧是种坚持</span>
                        <span class="layui-badge layui-bg-gray">懒癌患者</span> -->
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<script>
var vm = new Vue({
    el: "#app",
    data: {
        company_name: {
            "key": "company_name",
            "name": "单位名称",
            "checked": false
        },
        address: {
            "key": "address",
            "name": "地址",
            "checked": false
        },
        legal_representative: {
            "key": "legal_representative",
            "name": "法定代表人",
            "checked": false
        },
        contact: {
            "key": "contact",
            "name": "联系人",
            "checked": false
        },
        phone: {
            "key": "phone",
            "name": "联系电话",
            "checked": false
        },
        credit_code: {
            "key": "credit_code",
            "name": "社会统一信用代码（营业执照、组织机构代码）",
            "checked": false
        },
        industry_type: {
            "key": "industry_type",
            "name": "行业类别",
            "checked": false
        },
        bgs: {
            "key": "bgs",
            "name": "报告书或报告表",
            "children": [{
                    "key": "bgs_pfwh",
                    "name": "批复文号",
                    "checked": false
                },
                {
                    "key": "bgs_yswh",
                    "name": "验收文号",
                    "checked": false
                }
            ]
        },
        djb: {
            "key": "djb",
            "name": "登记表或现状环评 ",
            "children": [{
                "key": "djb_bawh",
                "name": "备案文号",
                "checked": false
            }]
        },
        wrw: {
            "key": "wrw",
            "name": "主要污染物类别",
            "children": [{
                    "key": "wrw_fs",
                    "name": "废水",
                    "checked": false
                },
                {
                    "key": "wrw_fq",
                    "name": "废气",
                    "checked": false
                },
                {
                    "key": "wrw_fw",
                    "name": "固体废物",
                    "checked": false
                },
                {
                    "key": "wrw_zs",
                    "name": "噪声",
                    "checked": false
                }
            ]
        },
        is_zdpwdw: {
            "key": "is_zdpwdw",
            "name": "是否为重点排污单位（年度）",
            "checked": false
        },
        zyscgy: {
            "key": "zyscgy",
            "name": "主要生产工艺",
            "checked": false
        },
        zycp: {
            "key": "zycp",
            "name": "主要产品",
            "checked": false
        },
        zyyl: {
            "key": "zyyl",
            "name": "主要原料",
            "checked": false
        },
        fs: {
            "key": "fs",
            "name": "废水 ",
            "children": [{
                "key": "fs_zlgy",
                "name": "废水治理工艺",
                "checked": false
            }, {
                "key": "fs_pfksl",
                "name": "废水排放口数量",
                "checked": false
            }, {
                "key": "fs_sfgf",
                "name": "是否设置规范化废水排放口",
                "checked": false
            }, {
                "key": "fs_pfqs",
                "name": "废水排放去向",
                "checked": false
            }]
        },
        fq: {
            "key": "fq",
            "name": "废气",
            "children": [{
                "key": "fq_zlgy",
                "name": "废气治理工艺",
                "checked": false
            }, {
                "key": "fq_pfksl",
                "name": "废气排放口数量",
                "checked": false
            }, {
                "key": "fq_sfgf",
                "name": "是否设置规范化废气排放口",
                "checked": false
            }]
        },
        fw: {
            "key": "fw",
            "name": "危险废物",
            "children": [{
                "key": "fw_sfywfbz",
                "name": "是否有危废标志",
                "checked": false
            }, {
                "key": "fw_sfgf",
                "name": "储存场所是否规范",
                "checked": false
            }, {
                "key": "fw_sfflcf",
                "name": "是否分类存放",
                "checked": false
            }]
        },
        zd: {
            "key": "zd",
            "name": "自动监测设施",
            "children": [{
                "key": "zd_jcfs",
                "name": "废水（监测因子）",
                "checked": false
            }, {
                "key": "zd_jcfq",
                "name": "废气（监测因子）",
                "checked": false
            }, {
                "key": "zd_lwqk",
                "name": "联网情况",
                "checked": false
            }]
        },
        gk1: {
            "key": "gk",
            "name": "工况用电监测装置",
            "children": [{
                "key": "gk_sfaz",
                "name": "是否安装工况用电监测装置",
                "checked": false
            }, {
                "key": "gk_azsl",
                "name": "工况用电监测装置数量",
                "checked": false
            }]
        },
        gk2: {
            "key": "gk",
            "name": "环境信息公开方式",
            "children": [{
                "key": "gk_gkfs",
                "name": "公示栏或电子屏",
                "checked": false
            }, {
                "key": "gk_gkwz",
                "name": "网站",
                "checked": false
            }]
        },
        fx: {
            "key": "fx",
            "name": "环境风险源",
            "children": [{
                "key": "fx_sfyjya",
                "name": "是否编制突发环境事件应急预案",
                "checked": false
            }, {
                "key": "fx_sfyaba",
                "name": "应急预案是否备案",
                "checked": false
            }]
        },
        fsy: {
            "key": "fsy",
            "name": "放射源",
            "children": [{
                "key": "fsy_fsyzl",
                "name": "放射源种类",
                "checked": false
            }, {
                "key": "fsy_twsmc",
                "name": "放射性同位素名称",
                "checked": false
            }, {
                "key": "fsy_fsysl",
                "name": "放射源数量",
                "checked": false
            }, {
                "key": "fsy_xkzbh",
                "name": "辐射安全许可证编号",
                "checked": false
            }]
        },
        sx: {
            "key": "sx",
            "name": "射线装置",
            "children": [{
                "key": "sx_zzzl",
                "name": "射线装置种类",
                "checked": false
            }, {
                "key": "sx_zzmc",
                "name": "射线装置名称",
                "checked": false
            }, {
                "key": "sx_zzsl",
                "name": "射线装置数量",
                "checked": false
            }]
        },
        pwxkzbh: {
            "key": "pwxkzbh",
            "name": "排污许可证编号",
            "checked": false
        },
        tqyj: {
            "key": "tqyj",
            "name": "重污染天气应急",
            "children": [{
                "key": "tqyj_sfsyyjdw",
                "name": "是否属于重污染天气应急减排单位",
                "checked": false
            }, {
                "key": "tqyj_sfyjya",
                "name": "是否制订重污染天气应急预案并备案",
                "checked": false
            }, {
                "key": "tqyj_sfhmqy",
                "name": "是否属于豁免名单内企业",
                "checked": false
            }]
        },
    },
    methods: {

    }
});


var insTb = null;
layui.use(['layer', 'form', 'admin', 'table', 'util', 'dropdown', 'laydate', 'mousewheel'], function() {
    var $ = layui.jquery;
    var layer = layui.layer;
    var form = layui.form;
    var table = layui.table;
    var util = layui.util;
    var admin = layui.admin;
    var laydate = layui.laydate;


    if ('初使化页面数据') {
        $('#search_companyName').val(admin.getLayerData().search_companyName);
    }

    // 实现横向滚动
    $('#demoMw2').on('mousewheel', function(event) {
        $(this).stop();
        $(this).animate({ 'scrollLeft': $(this).scrollLeft() - event.deltaFactor * event.deltaY * 2 }, 80);
        event.stopPropagation();
        event.preventDefault();
    });



    $('table td.item').click(function() {
        switch ($(this).attr('title')) {
            case 'company_name':
                vm.company_name.checked = !vm.company_name.checked;
                break;
            case 'address':
                vm.address.checked = !vm.address.checked;
                break;
            case 'legal_representative':
                vm.legal_representative.checked = !vm.legal_representative.checked;
                break;
            case 'contact':
                vm.contact.checked = !vm.contact.checked;
                break;
            case 'phone':
                vm.phone.checked = !vm.phone.checked;
                break;
            case 'credit_code':
                vm.credit_code.checked = !vm.credit_code.checked;
                break;
            case 'industry_type':
                vm.industry_type.checked = !vm.industry_type.checked;
                break;
            case 'bgs_pfwh':
                vm.bgs.children[0].checked = !vm.bgs.children[0].checked;
                break;
            case 'bgs_yswh':
                vm.bgs.children[1].checked = !vm.bgs.children[1].checked;
                break;
            case 'djb_bawh':
                vm.djb.children[0].checked = !vm.djb.children[0].checked;
                break;
            case 'wrw_fs':
                vm.wrw.children[0].checked = !vm.wrw.children[0].checked;
                break;
            case 'wrw_fq':
                vm.wrw.children[1].checked = !vm.wrw.children[1].checked;
                break;
            case 'wrw_fw':
                vm.wrw.children[2].checked = !vm.wrw.children[2].checked;
                break;
            case 'wrw_zs':
                vm.wrw.children[3].checked = !vm.wrw.children[3].checked;
                break;
            case 'is_zdpwdw':
                vm.is_zdpwdw.checked = !vm.is_zdpwdw.checked;
                break;
            case 'zyscgy':
                vm.zyscgy.checked = !vm.zyscgy.checked;
                break;
            case 'zycp':
                vm.zycp.checked = !vm.zycp.checked;
                break;
            case 'zyyl':
                vm.zyyl.checked = !vm.zyyl.checked;
                break;
            case 'fs_zlgy':
                vm.fs.children[0].checked = !vm.fs.children[0].checked;
                break;
            case 'fs_pfksl':
                vm.fs.children[1].checked = !vm.fs.children[1].checked;
                break;
            case 'fs_sfgf':
                vm.fs.children[2].checked = !vm.fs.children[2].checked;
                break;
            case 'fs_pfqs':
                vm.fs.children[3].checked = !vm.fs.children[3].checked;
                break;
            case 'fq_zlgy':
                vm.fq.children[0].checked = !vm.fq.children[0].checked;
                break;
            case 'fq_pfksl':
                vm.fq.children[1].checked = !vm.fq.children[1].checked;
                break;
            case 'fq_sfgf':
                vm.fq.children[2].checked = !vm.fq.children[2].checked;
                break;
            case 'fw_sfywfbz':
                vm.fw.children[0].checked = !vm.fw.children[0].checked;
                break;
            case 'fw_sfgf':
                vm.fw.children[1].checked = !vm.fw.children[1].checked;
                break;
            case 'fw_sfflcf':
                vm.fw.children[2].checked = !vm.fw.children[2].checked;
                break;
            case 'zd_jcfs':
                vm.zd.children[0].checked = !vm.zd.children[0].checked;
                break;
            case 'zd_jcfq':
                vm.zd.children[1].checked = !vm.zd.children[1].checked;
                break;
            case 'zd_lwqk':
                vm.zd.children[2].checked = !vm.zd.children[2].checked;
                break;
            case 'gk_sfaz':
                vm.gk1.children[0].checked = !vm.gk1.children[0].checked;
                break;
            case 'gk_azsl':
                vm.gk1.children[1].checked = !vm.gk1.children[1].checked;
                break;
            case 'gk_gkfs':
                vm.gk2.children[0].checked = !vm.gk2.children[0].checked;
                break;
            case 'gk_gkwz':
                vm.gk2.children[1].checked = !vm.gk2.children[1].checked;
                break;
            case 'fx_sfyjya':
                vm.fx.children[0].checked = !vm.fx.children[0].checked;
                break;
            case 'fx_sfyaba':
                vm.fx.children[1].checked = !vm.fx.children[1].checked;
                break;
            case 'fsy_fsyzl':
                vm.fsy.children[0].checked = !vm.fsy.children[0].checked;
                break;
            case 'fsy_twsmc':
                vm.fsy.children[1].checked = !vm.fsy.children[1].checked;
                break;
            case 'fsy_fsysl':
                vm.fsy.children[2].checked = !vm.fsy.children[2].checked;
                break;
            case 'fsy_xkzbh':
                vm.fsy.children[3].checked = !vm.fsy.children[3].checked;
                break;
            case 'sx_zzzl':
                vm.sx.children[0].checked = !vm.sx.children[0].checked;
                break;
            case 'sx_zzmc':
                vm.sx.children[1].checked = !vm.sx.children[1].checked;
                break;
            case 'sx_zzsl':
                vm.sx.children[2].checked = !vm.sx.children[2].checked;
                break;
            case 'pwxkzbh':
                vm.pwxkzbh.checked = !vm.pwxkzbh.checked;
                break;
            case 'tqyj_sfsyyjdw':
                vm.tqyj.children[0].checked = !vm.tqyj.children[0].checked;
                break;
            case 'tqyj_sfyjya':
                vm.tqyj.children[1].checked = !vm.tqyj.children[1].checked;
                break;
            case 'tqyj_sfhmqy':
                vm.tqyj.children[2].checked = !vm.tqyj.children[2].checked;
                break;
        }
    });

    $('#fnSure').click(function() {
        



        console.log(JSON.stringify(data));

        // layui.use(['layer', 'form', 'admin', 'table', 'util', 'dropdown', 'laydate', 'tableX'], function() {
        //     var $ = layui.jquery;
        //     var layer = layui.layer;
        //     var form = layui.form;
        //     var table = layui.table;
        //     var util = layui.util;
        //     var admin = layui.admin;
        //     var laydate = layui.laydate;
        //     var tableX = layui.tableX;


        //     // let param = new URLSearchParams()
        //     // param.append('headersJson', JSON.stringify(data));
        //     // param.append('search_companyName', vm.search_companyName);
        //     // axios({
        //     //     method: 'post',
        //     //     url: baseUrl + 'ele/info/downLoadExcel',
        //     //     headers: {
        //     //         'Authorization': 'Bearer ' + $.cookie('login_sid_t_we'),
        //     //     },
        //     //     data: param
        //     // }).then(function(res) {
        //     //     if ( res.data.code == 0 ) {
        //     //     }
        //     // });

        //     tableX.exportDataBack(baseUrl + 'ele/info/downLoadExcel', {
        //         headersJson: JSON.stringify(data),
        //         search_companyName: vm.search_companyName
        //     }, 'post');
        // });
    });

    $('#exportExcelSubmit').click(function(event) {
        if ('组合数据') {
            var data = [];
            if (vm.company_name.checked) {
                data.push({
                    "key": "company_name",
                    "name": "单位名称",
                });
            }
            if (vm.address.checked) {
                data.push({
                    "key": "address",
                    "name": "地址",
                });
            }
            if (vm.legal_representative.checked) {
                data.push({
                    "key": "legal_representative",
                    "name": "法定代表人",
                })
            }
            if (vm.contact.checked) {
                data.push({
                    "key": "contact",
                    "name": "联系人",
                })
            }
            if (vm.phone.checked) {
                data.push({
                    "key": "phone",
                    "name": "联系电话",
                })
            }

            if (vm.credit_code.checked) {
                data.push({
                    "key": "credit_code",
                    "name": "社会统一信用代码（营业执照、组织机构代码）",
                })
            }

            if (vm.industry_type.checked) {
                data.push({
                    "key": "industry_type",
                    "name": "社会统一信用代码（营业执照、组织机构代码）",
                })
            }

            if (vm.industry_type.checked) {
                data.push({
                    "key": "industry_type",
                    "name": "社会统一信用代码（营业执照、组织机构代码）",
                })
            }

            if (vm.bgs.children[0].checked || vm.bgs.children[1].checked) {
                var list = [];
                if (vm.bgs.children[0].checked) {
                    list.push({
                        "key": "bgs_pfwh",
                        "name": "批复文号",
                    })
                }
                if (vm.bgs.children[1].checked) {
                    list.push({
                        "key": "bgs_yswh",
                        "name": "验收文号",
                    })
                }
                data.push({
                    "key": "bgs",
                    "name": "报告书或报告表",
                    "children": list
                })
            }




            if (vm.bgs.children[0].checked) {
                var list = [];
                if (vm.djb.children[0].checked) {
                    list.push({
                        "key": "djb_bawh",
                        "name": "备案文号",
                    })
                }
                data.push({
                    "key": "djb",
                    "name": "登记表或现状环评",
                    "children": list
                })
            }

            if (vm.wrw.children[0].checked || vm.wrw.children[1].checked || vm.wrw.children[2].checked || vm.wrw.children[3].checked) {
                var list = [];
                if (vm.wrw.children[0].checked) {
                    list.push({
                        "key": "wrw_fs",
                        "name": "废水",
                    })
                }
                if (vm.wrw.children[1].checked) {
                    list.push({
                        "key": "wrw_fq",
                        "name": "废气",
                    })
                }
                if (vm.wrw.children[2].checked) {
                    list.push({
                        "key": "wrw_fw",
                        "name": "固体废物",
                    })
                }
                if (vm.wrw.children[3].checked) {
                    list.push({
                        "key": "wrw_zs",
                        "name": "噪声",
                    })
                }
                data.push({
                    "key": "wrw",
                    "name": "主要污染物类别",
                    "children": list
                })
            }


            if (vm.is_zdpwdw.checked) {
                data.push({
                    "key": "is_zdpwdw",
                    "name": "是否为重点排污单位（年度）",
                })
            }

            if (vm.zyscgy.checked) {
                data.push({
                    "key": "zyscgy",
                    "name": "主要生产工艺",
                })
            }

            if (vm.zycp.checked) {
                data.push({
                    "key": "zycp",
                    "name": "主要产品",
                })
            }

            if (vm.zyyl.checked) {
                data.push({
                    "key": "zyyl",
                    "name": "主要原料",
                })
            }


            if (vm.fs.children[0].checked || vm.fs.children[1].checked || vm.fs.children[2].checked || vm.fs.children[3].checked) {
                var list = [];
                if (vm.fs.children[0].checked) {
                    list.push({
                        "key": "fs_zlgy",
                        "name": "废水治理工艺",
                    })
                }
                if (vm.fs.children[1].checked) {
                    list.push({
                        "key": "fs_pfksl",
                        "name": "废水排放口数量",
                    })
                }
                if (vm.fs.children[2].checked) {
                    list.push({
                        "key": "fs_sfgf",
                        "name": "是否设置规范化废水排放口",
                    })
                }
                if (vm.fs.children[3].checked) {
                    list.push({
                        "key": "fs_pfqs",
                        "name": "废水排放去向",
                    })
                }
                data.push({
                    "key": "fs",
                    "name": "废水",
                    "children": list
                })
            }

            if (vm.fq.children[0].checked || vm.fq.children[1].checked || vm.fq.children[2].checked) {
                var list = [];
                if (vm.fq.children[0].checked) {
                    list.push({
                        "key": "fq_zlgy",
                        "name": "废气治理工艺",
                    })
                }
                if (vm.fq.children[1].checked) {
                    list.push({
                        "key": "fq_pfksl",
                        "name": "废气排放口数量",
                    })
                }
                if (vm.fq.children[2].checked) {
                    list.push({
                        "key": "fq_sfgf",
                        "name": "是否设置规范化废气排放口",
                    })
                }
                data.push({
                    "key": "fq",
                    "name": "废气",
                    "children": list
                })
            }

            if (vm.fw.children[0].checked || vm.fw.children[1].checked || vm.fw.children[2].checked) {
                var list = [];
                if (vm.fw.children[0].checked) {
                    list.push({
                        "key": "fw_sfywfbz",
                        "name": "是否有危废标志",
                    })
                }
                if (vm.fw.children[1].checked) {
                    list.push({
                        "key": "fw_sfgf",
                        "name": "储存场所是否规范",
                    })
                }
                if (vm.fw.children[2].checked) {
                    list.push({
                        "key": "fw_sfflcf",
                        "name": "是否分类存放",
                    })
                }
                data.push({
                    "key": "fw",
                    "name": "危险废物",
                    "children": list
                })
            }

            if (vm.zd.children[0].checked || vm.zd.children[1].checked || vm.zd.children[2].checked) {
                var list = [];
                if (vm.zd.children[0].checked) {
                    list.push({
                        "key": "zd_jcfs",
                        "name": "废水（监测因子）",
                    })
                }
                if (vm.zd.children[1].checked) {
                    list.push({
                        "key": "zd_jcfq",
                        "name": "废气（监测因子）",
                    })
                }
                if (vm.zd.children[2].checked) {
                    list.push({
                        "key": "fw_sfflcf",
                        "name": "联网情况",
                    })
                }
                data.push({
                    "key": "zd",
                    "name": "自动监测设施",
                    "children": list
                })
            }

            if (vm.gk1.children[0].checked || vm.gk1.children[1].checked) {
                var list = [];
                if (vm.gk1.children[0].checked) {
                    list.push({
                        "key": "gk_sfaz",
                        "name": "是否安装工况用电监测装置",
                    })
                }
                if (vm.gk1.children[1].checked) {
                    list.push({
                        "key": "gk_azsl",
                        "name": "工况用电监测装置数量",
                    })
                }
                data.push({
                    "key": "gk",
                    "name": "工况用电监测装置",
                    "children": list
                })
            }

            if (vm.gk2.children[0].checked || vm.gk2.children[1].checked) {
                var list = [];
                if (vm.gk2.children[0].checked) {
                    list.push({
                        "key": "gk_gkfs",
                        "name": "公示栏或电子屏",
                    })
                }
                if (vm.gk2.children[1].checked) {
                    list.push({
                        "key": "gk_gkwz",
                        "name": "网站",
                    })
                }
                data.push({
                    "key": "gk",
                    "name": "环境信息公开方式",
                    "children": list
                })
            }

            if (vm.fx.children[0].checked || vm.fx.children[1].checked) {
                var list = [];
                if (vm.fx.children[0].checked) {
                    list.push({
                        "key": "fx_sfyjya",
                        "name": "是否编制突发环境事件应急预案",
                    })
                }
                if (vm.fx.children[1].checked) {
                    list.push({
                        "key": "fx_sfyaba",
                        "name": "应急预案是否备案",
                    })
                }
                data.push({
                    "key": "fx",
                    "name": "环境风险源",
                    "children": list
                })
            }

            if (vm.fsy.children[0].checked || vm.fsy.children[1].checked || vm.fsy.children[2].checked || vm.fsy.children[3].checked) {
                var list = [];
                if (vm.fsy.children[0].checked) {
                    list.push({
                        "key": "fsy_fsyzl",
                        "name": "放射源种类",
                    })
                }
                if (vm.fsy.children[1].checked) {
                    list.push({
                        "key": "fsy_twsmc",
                        "name": "放射性同位素名称",
                    })
                }
                if (vm.fsy.children[2].checked) {
                    list.push({
                        "key": "fsy_fsysl",
                        "name": "放射源数量",
                    })
                }
                if (vm.fsy.children[3].checked) {
                    list.push({
                        "key": "fsy_xkzbh",
                        "name": "辐射安全许可证编号",
                    })
                }
                data.push({
                    "key": "fsy",
                    "name": "放射源",
                    "children": list
                })
            }

            if (vm.sx.children[0].checked || vm.sx.children[1].checked || vm.sx.children[2].checked) {
                var list = [];
                if (vm.sx.children[0].checked) {
                    list.push({
                        "key": "sx_zzzl",
                        "name": "射线装置种类",
                    })
                }
                if (vm.sx.children[1].checked) {
                    list.push({
                        "key": "sx_zzmc",
                        "name": "射线装置名称",
                    })
                }
                if (vm.sx.children[2].checked) {
                    list.push({
                        "key": "sx_zzsl",
                        "name": "射线装置数量",
                    })
                }
                data.push({
                    "key": "sx",
                    "name": "射线装置",
                    "children": list
                })
            }

            if (vm.pwxkzbh.checked) {
                data.push({
                    "key": "pwxkzbh",
                    "name": "排污许可证编号",
                })
            }

            if (vm.tqyj.children[0].checked || vm.tqyj.children[1].checked || vm.tqyj.children[2].checked) {
                var list = [];
                if (vm.tqyj.children[0].checked) {
                    list.push({
                        "key": "tqyj_sfsyyjdw",
                        "name": "是否属于重污染天气应急减排单位",
                    })
                }
                if (vm.tqyj.children[1].checked) {
                    list.push({
                        "key": "tqyj_sfyjya",
                        "name": "是否制订重污染天气应急预案并备案",
                    })
                }
                if (vm.tqyj.children[2].checked) {
                    list.push({
                        "key": "tqyj_sfhmqy",
                        "name": "是否属于豁免名单内企业",
                    })
                }
                data.push({
                    "key": "tqyj",
                    "name": "重污染天气应急",
                    "children": list
                })
            }
        }
        $('#search_companyName').val(admin.getLayerData().search_companyName);
        $('#headersJson').val(JSON.stringify(data));
        $('#exportExcelForm').attr('action', baseUrl + 'ele/info/downLoadExcel')
        $('#submitBtn').trigger('click');
    });
});
</script>